---
defines:
- &card
  Card.LegacyPolaroid

- &main-arrangement-slot
  arrangement:
    type: Arrangement.Grid
    slots:
      card: *card

- &home-page
  type: Layout.HamburgerBasement
  slots:
    # FIXME remove fractions
    top: Banner.App
    middle: 'Navigation.SearchBox(halign: center)'
    bottom:
      type: ContentGroup.Set
      properties:
        expand: true
        halign: center
        valign: center
        max-children: 6
      slots:
        arrangement:
          shortdef: 'Arrangement.Overflow(orientation: horizontal)'
          slots:
            card: *card
    basement:
      type: Layout.InfiniteScrolling
      references:
        lazy-load: basement-sets
      slots:
        content:
          shortdef: 'ContentGroup.ContentGroup(expand: true)'
          slots:
            <<: *main-arrangement-slot
            selection:
              type: Selection.AllSets
              id: basement-sets

- &set-page
  type: Layout.InfiniteScrolling
  references:
    lazy-load: set-articles
  slots:
    content:
      type: ContentGroup.ContentGroup
      slots:
        <<: *main-arrangement-slot
        selection:
          type: Selection.ArticlesForSet
          id: set-articles
        title:
          type: ContentGroup.DynamicTitle
          properties:
            format-string: '%s'
            halign: center
            hexpand: true

- &search-page
  shortdef: 'Layout.Box(orientation: vertical)'
  slots:
    contents:
    - 'Banner.Search(halign: center)'
    - Decoration.Separator
    - type: Layout.InfiniteScrolling
      references:
        lazy-load: search-results
      slots:
        content:
          type: ContentGroup.ContentGroup
          slots:
            <<: *main-arrangement-slot
            selection:
              type: Selection.Search
              id: search-results
            no-results: ContentGroup.NoResultsMessage
          styles:
          - search-results

- &article-page
  type: Layout.ArticleStack
  slots:
    card: 'Card.KnowledgeDocument(show-toc: true)'

root:
  type: Controller.Mesh
  slots:
    window:
      type: Window.Simple
      slots:
        search: Navigation.SearchBox
        navigation: Layout.Navigation
        lightbox:
          type: ContentGroup.MediaLightbox
          slots:
            card: Card.Media
        pager:
          type: Pager.ParallaxBackground
          properties:
            background-image-uri: "resource:///com/endlessm/knowledge/data/images/tools/forest.jpg"
          slots:
            home-page: *home-page
            set-page: *set-page
            search-page: *search-page
            article-page: *article-page
